import{h as m,w as D,g as L,r as M,F as j,a as F,o as q,b as y,c as E,d as V,e as x,f as k,i as C,j as O,k as W,u as v,l as A,m as B,n as P,p as $,q as K,s as R}from"./index-BISKVYYs.js";const S={props:["currentItem","formModelsAndRules","dynamicData"],setup(r,{expose:c}){let l;function f(e){if(e.__vModel__){let t=e.__config__.wrapWithFormItem?l||{}:r.formModelsAndRules;return{modelValue:t[e.__vModel__],"onUpdate:modelValue"(_){t[e.__vModel__]=_}}}else return{}}function d(e){const{required:t,showLabel:_}=e.__config__;let{label:n,labelWidth:o}=e.__config__;o=o?o+"px":null,_===!1&&(o="0",n="");const s={labelWidth:o,label:n,prop:e.__vModel__,required:t};return m(M("el-form-item"),s,()=>u(e,!0))}function i(e){const{tag:t}=e.__config__;if(r.formModelsAndRules&&t==="el-form"){l=r.formModelsAndRules[e.__props__.model];const _=r.formModelsAndRules[e.__props__.rules];return m(M(t),{...e.__props__,...e.__native__,...f(e),model:l,rules:_},p(e))}else return m(M(t),{...e.__props__,...e.__native__,...f(e)},p(e))}function p(e){let t={};for(const _ in e.__slots__){if(typeof e.__slots__[_]=="string"){t[_]=()=>e.__slots__[_];continue}if(typeof e.__slots__[_]=="function"){t[_]=e.__slots__[_];continue}e.__slots__[_].length!==0&&(t[_]=()=>e.__slots__[_].map(n=>u(n)))}return t}function b(e){const t=e.__data__;let _={};if(t){const{name:n,source:o}=t;if(o==="static")_[n]=t.static[n];else{const s=e.__refs__[n];t.dynamic.dataKey?_[n]=r.dynamicData[s]&&r.dynamicData[s][t.dynamic.dataKey]||[]:_[n]=r.dynamicData[s]||[]}}return{__data__:_}}function w(e){let t={...e,...b(e)};return m(j,{conf:t,...f(e)})}function h(e){const{__directives__:t}=e,_=[];if(t)for(const n in t){const o=t[n],s={};o.modifiers&&o.modifiers.forEach(g=>{s[g]=!0}),_.push([F(n),o.value,o.arg,s])}return _}function u(e,t){if(typeof e=="string")return m("span",e);if(typeof e=="function")return e;const{layout:_,tag:n,wrapWithFormItem:o}=e.__config__;n||console.error("no tag setting in __config__");let s;o&&!t?s=d(e):_==="containerItem"||_==="rawItem"?s=i(e):_==="fixedItem"?s=w(e):console.error("invalid layout");const g=h(e);return g.length>0?D(s,g):s}const a=L();return c({instance:a}),()=>u(r.currentItem)}},T={__name:"Render",props:{drawItemList:{type:Array,required:!0},modelValue:{type:Object,required:!0}},emits:["update:modelValue"],setup(r,{expose:c,emit:l}){const f=r,d=l;q(()=>{});const i=y(f.modelValue||{});function p(a,e,t){for(const _ of a)if(!(typeof _=="string"||typeof _=="function")){if(_.__id__==="form")e=i.value[_.__props__.model]||{},t=i.value[_.__props__.rules]||{},i.value[_.__props__.model]=e,i.value[_.__props__.rules]=t;else if(_.__vModel__){const{__config__:n,__props__:o}=_;if(_.__config__.wrapWithFormItem){if(e&&(e[_.__vModel__]=n.defaultValue),t){const s=b(_);s.length>0&&(t[_.__vModel__]=s)}}else i.value[_.__vModel__]=n.defaultValue}_.__slots__&&Array.isArray(_.__slots__.default)&&p(_.__slots__.default,e,t)}}function b(a){const e=[],{__config__:t,__props__:_}=a;if(A[t.tag]){if(t.required){let n=Array.isArray(t.defaultValue)?"array":t.defaultValueType;!n&&t.tag==="el-input-number"&&(n="number");let o=Array.isArray(t.defaultValue)?`请至少选择一个${t.label}`:_&&_.placeholder||"";o===void 0&&(o=`${t.label}不能为空`),e.push({required:!0,type:n,message:o,trigger:A[t.tag]})}t.regList&&Array.isArray(t.regList)&&t.regList.forEach(n=>{n.pattern&&e.push({pattern:new RegExp(n.pattern),message:n.message,trigger:A[t.tag]})})}return e}E(()=>{p(f.drawItemList),d("update:modelValue",i.value)});function w(a,e){const t=cloneDrawItem(O(B[a]))||{__config__:{tag:a,layout:"rawItem"}};return t.__slots__={},t.__refs__={},t.__props__={},typeof e=="object"&&Object.keys(e).forEach(_=>{const n=e[_];typeof n=="object"&&t[_]?Object.assign(t[_],n):t[_]=n}),t}function h(){const a={};for(const e of u.value)Object.assign(a,e.instance.refs);return a}c({buildDrawItem:w,getRefs:h});const u=y();return(a,e)=>(V(!0),x(C,null,k(r.drawItemList,t=>(V(),W(v(S),{"current-item":t,"form-models-and-rules":v(i),ref_for:!0,ref_key:"drawList",ref:u},null,8,["current-item","form-models-and-rules"]))),256))}},U={style:{padding:"20px"}},N={__name:"index",setup(r){const c=y(R),l=y(R);return P(l,f=>{console.info(f)},{deep:!0}),(f,d)=>(V(),x("div",U,[$(T,{"draw-item-list":v(c),modelValue:v(l),"onUpdate:modelValue":d[0]||(d[0]=i=>K(l)?l.value=i:null)},null,8,["draw-item-list","modelValue"])]))}};export{N as default};
